local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")
local MarketplaceService = game:GetService("MarketplaceService")
local TeleportService = game:GetService("TeleportService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local LinkWebHook = "https://discord.com/api/webhooks/1343591803101904916/z7lDVIhJDsOMx6JYeGHP039WD9R-RSsV6YMjYUDsES1MRdgDJfLv8bKJ1PQlnw6xk4LS"

local GameID = game.PlaceId
local ServerID = game.JobId

-- L·∫•y t√™n game
local gameName = "Unknown"
pcall(function()
    gameName = MarketplaceService:GetProductInfo(GameID).Name
end)

-- Ki·ªÉm tra thi·∫øt b·ªã
local deviceType = "PC"
if UserInputService.TouchEnabled and not UserInputService.KeyboardEnabled then
    deviceType = "Mobile"
end

-- Ki·ªÉm tra executor
local executor = "Unknown"
if syn then
    executor = "Synapse X"
elseif KRNL_LOADED then
    executor = "KRNL"
elseif fluxus then
    executor = "Fluxus"
elseif getexecutorname then
    local success, execName = pcall(getexecutorname)
    if success then
        executor = execName
    end
end

-- Qu·ªëc gia ng∆∞·ªùi ch∆°i
local locale = Players.LocalPlayer.LocaleId:lower()
local country = "Kh√¥ng x√°c ƒë·ªãnh"
local countryMap = {
    vn = "Vi·ªát Nam", th = "Th√°i Lan", id = "Indonesia", ph = "Philippines",
    my = "Malaysia", us = "Hoa K·ª≥", br = "Brazil", kr = "H√†n Qu·ªëc",
    jp = "Nh·∫≠t B·∫£n", de = "ƒê·ª©c", fr = "Ph√°p", ru = "Nga"
}
for code, name in pairs(countryMap) do
    if locale:find(code) then
        country = name break
    end
end

-- Qu·ªëc gia server d·ª±a theo ping
local serverLocation = "Kh√¥ng x√°c ƒë·ªãnh"
pcall(function()
    local ping = tonumber(game:GetService("Stats").Network.ServerStatsItem["Data Ping"]:GetValueString():gsub(" ms", ""))
    if ping then
        if ping <= 80 then
            serverLocation = "üá∏üá¨ Singapore"
        elseif ping <= 150 then
            serverLocation = "üá≠üá∞ Hong Kong / üáµüá≠ Philippines"
        elseif ping <= 200 then
            serverLocation = "üáØüáµ Japan / üá∞üá∑ Korea"
        elseif ping <= 300 then
            serverLocation = "üá∫üá∏ US West"
        else
            serverLocation = "üåç Xa ho·∫∑c kh√¥ng r√µ"
        end
    end
end)

-- Lo·∫°i server
local serverType = game.PrivateServerId ~= "" and not game.PrivateServerOwnerId == 0 and "üîí Private Server" or "üåê Public Server"

-- M√£ teleport
local teleportCode = string.format(
    'game:GetService("TeleportService"):TeleportToPlaceInstance("%s", "%s", game.Players.LocalPlayer)', 
    GameID, ServerID
)

-- G·ª≠i webhook
local function sendWebhook(title, message, id)
    local data = {
        ["username"] = "NomDom Notifier",
        ["embeds"] = {{
            ["title"] = title,
            ["description"] = message,
            ["color"] = tonumber(0x310a4c),
            ["footer"] = {["text"] = "Sent from NomDom Notifier"}
        }]
    }

    if id then data["message_id"] = id end

    local jsonData = HttpService:JSONEncode(data)
    local response
    pcall(function()
        response = (syn and syn.request or request)({
            Url = LinkWebHook,
            Method = "POST",
            Headers = {["Content-Type"] = "application/json"},
            Body = jsonData
        })
    end)
    return response
end

-- G·ª≠i th√¥ng tin l·∫ßn ƒë·∫ßu
local username = Players.LocalPlayer.Name
local displayName = Players.LocalPlayer.DisplayName
local initialMsg = "**üë§ Ng∆∞·ªùi ch∆°i:** " .. username .. " (T√™n gi·∫£: " .. displayName .. ")" ..
"\n**üéÆ Game:** " .. gameName ..
"\n**üåê Qu·ªëc gia ng∆∞·ªùi ch∆°i:** " .. country ..
"\n**üì° Qu·ªëc gia server:** " .. serverLocation ..
"\n**üíª Thi·∫øt b·ªã:** " .. deviceType ..
"\n**üß™ Executor:** " .. executor ..
"\n**üõ†Ô∏è Lo·∫°i server:** " .. serverType ..
"\n**üÜî Place ID:** " .. GameID ..
"\n**üßæ Server ID:** `" .. ServerID .. "`" ..
"\n\n**üìã M√£ Teleport:** ```lua\n" .. teleportCode .. "\n```"

sendWebhook("üìå ƒê√£ v√†o game", initialMsg)

-- C·∫≠p nh·∫≠t tr·∫°ng th√°i m·ªói 1 gi√¢y
local secondsPassed = 0
local scriptRunning = true

task.spawn(function()
    while scriptRunning do
        secondsPassed += 1
        local msg = string.format("üü¢ Script v·∫´n ƒëang ho·∫°t ƒë·ªông - ƒê√£ ch·∫°y %d gi√¢y", secondsPassed)
        sendWebhook("‚è±Ô∏è Tr·∫°ng th√°i script", msg)
        task.wait(1)
    end
end)

-- T·ª± ƒë·ªông b√°o d·ª´ng n·∫øu tho√°t ho·∫∑c l·ªói
game:BindToClose(function()
    scriptRunning = false
    sendWebhook("üî¥ Script ƒë√£ d·ª´ng ho·∫°t ƒë·ªông (tho√°t game ho·∫∑c l·ªói)", "")
end)
